'use strict';function RDSearch(options){if(!options.output){throw new Error('output is required parameter for RDSearch')}for(var param in RDSearch.defaults){this[param]=typeof options[param]!=='undefined'?options[param]:RDSearch.defaults[param]}if(typeof this.form==='string'){this.form=document.querySelector(this.form)}if(typeof this.output==='string'){this.output=document.querySelector(this.output)}this.input=this.form.querySelector('input[name="s"]');this.form.RDSearch=this;if(location.search){this.getResult(location.search)}if(this.form){this.addHandlers()}}RDSearch.defaults={handler:'bat/rd-search.php',filter:'*.html',template:'<h5 class="search-title"><a target="_top" href="#{href}" class="search-link">#{title}</a></h5>\n\t\t<p>...#{token}...</p>\n\t\t<p class="match"><em>Terms matched: #{count} - URL: #{href}</em></p>',form:null,input:null,output:null,mode:null,liveResults:5,minStrLength:3};RDSearch.prototype.addHandlers=function(){var _this=this;switch(this.mode){case'live':var timeoutId=void 0;this.input.addEventListener('focus',function(){if(_this.input.value.trim().length>=_this.minStrLength){clearTimeout(timeoutId);_this.output.classList.add('rd-search-show')}});this.input.addEventListener('blur',function(){timeoutId=setTimeout(function(){_this.output.classList.remove('rd-search-show')},1500)});this.output.addEventListener('mousemove',function(){clearTimeout(timeoutId);_this.output.classList.add('rd-search-show')});this.output.addEventListener('mouseleave',function(){timeoutId=setTimeout(function(){_this.output.classList.remove('rd-search-show')},1500)});this.input.addEventListener('input',function(){if(_this.input.value.trim().length>=_this.minStrLength){_this.output.classList.add('rd-search-show');_this.getResult({s:_this.input.value})}else{_this.output.classList.remove('rd-search-show')}});break;case'submit':this.form.addEventListener('submit',function(event){event.preventDefault();_this.getResult({s:_this.input.value})});break;}};RDSearch.prototype.getResult=function(params){var _this2=this;this.output.classList.add('rd-search-loading');var xhr=new XMLHttpRequest,req=new URLSearchParams(params);req.append('template',this.template);req.append('filter',this.filter);if(this.mode==='live'){req.append('liveSearch',true);req.append('liveCount',this.liveResults)}xhr.open('GET',this.handler+'?'+req.toString(),true);xhr.onreadystatechange=function(event){if(xhr.readyState===4&&xhr.status===200){_this2.output.innerHTML=xhr.response;_this2.output.classList.remove('rd-search-loading')}};xhr.send()};