/**
 * RD Search
 * @param {object} options
 * @param {string|Element} options.output - search result output element
 * @param {string|Element} [options.input] - search input element
 * @param {string} [options.filter] - search files filtration
 * @param {string} [options.handler] - search request handler file
 * @param {string} [options.template] - search result markup template
 * @param {string} [options.mode] - 'live', 'submit'
 * @param {number} [options.minStrLength] - minimum live search string length for searching
 * @constructor
 */
function RDSearch(t){if(!t.output)throw new Error("output is required parameter for RDSearch");for(var e in RDSearch.defaults)this[e]="undefined"!=typeof t[e]?t[e]:RDSearch.defaults[e];"string"==typeof this.form&&(this.form=document.querySelector(this.form)),"string"==typeof this.output&&(this.output=document.querySelector(this.output)),this.input=this.form.querySelector('input[name="s"]'),this.form.RDSearch=this,location.search&&this.getResult(location.search),this.form&&this.addHandlers()}RDSearch.defaults={handler:"bat/rd-search.php",filter:"*.html",template:'<h5 class="search-title"><a target="_top" href="#{href}" class="search-link">#{title}</a></h5>\n		<p>...#{token}...</p>\n		<p class="match"><em>Terms matched: #{count} - URL: #{href}</em></p>',form:null,input:null,output:null,mode:null,liveResults:5,minStrLength:3},RDSearch.prototype.addHandlers=function(){var t=this;switch(this.mode){case"live":var e;this.input.addEventListener("focus",function(){t.input.value.trim().length>=t.minStrLength&&(clearTimeout(e),t.output.classList.add("rd-search-show"))}),this.input.addEventListener("blur",function(){e=setTimeout(function(){t.output.classList.remove("rd-search-show")},1500)}),this.output.addEventListener("mousemove",function(){clearTimeout(e),t.output.classList.add("rd-search-show")}),this.output.addEventListener("mouseleave",function(){e=setTimeout(function(){t.output.classList.remove("rd-search-show")},1500)}),this.input.addEventListener("input",function(){t.input.value.trim().length>=t.minStrLength?(t.output.classList.add("rd-search-show"),t.getResult({s:t.input.value})):t.output.classList.remove("rd-search-show")});break;case"submit":this.form.addEventListener("submit",function(e){e.preventDefault(),t.getResult({s:t.input.value})})}},RDSearch.prototype.getResult=function(t){var e=this;this.output.classList.add("rd-search-loading");var s=new XMLHttpRequest,i=new URLSearchParams(t);i.append("template",this.template),i.append("filter",this.filter),"live"===this.mode&&(i.append("liveSearch",!0),i.append("liveCount",this.liveResults)),s.open("GET",this.handler+"?"+i.toString(),!0),s.onreadystatechange=function(t){4===s.readyState&&200===s.status&&(e.output.innerHTML=s.response,e.output.classList.remove("rd-search-loading"))},s.send()};